{"version":3,"file":"upload.service.js","sourceRoot":"","sources":["../../src/upload/upload.service.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,2CAA4C;AAC5C,2CAA8C;AAIvC,IAAM,aAAa,GAAnB,MAAM,aAAa;IACxB;QACE,eAAU,CAAC,MAAM,CAAC;YAChB,UAAU,EAAE,OAAO,CAAC,GAAG,CAAC,qBAAqB;YAC7C,OAAO,EAAE,OAAO,CAAC,GAAG,CAAC,kBAAkB;YACvC,UAAU,EAAE,OAAO,CAAC,GAAG,CAAC,qBAAqB;SAC9C,CAAC,CAAC;IACL,CAAC;IAGD,KAAK,CAAC,UAAU,CAAC,IAAyB;QACxC,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;YACrC,eAAU,CAAC,QAAQ;iBAChB,aAAa,CAAC,EAAE,aAAa,EAAE,OAAO,EAAE,EAAE,CAAC,KAAY,EAAE,MAAyB,EAAE,EAAE;gBACrF,IAAI,KAAK,EAAE,CAAC;oBACV,OAAO,MAAM,CAAC,KAAK,CAAC,CAAC;gBACvB,CAAC;gBACD,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;YAC7B,CAAC,CAAC;iBACD,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QACtB,CAAC,CAAC,CAAC;IACL,CAAC;IAGD,KAAK,CAAC,YAAY,CAAC,YAAoB;QACrC,MAAM,MAAM,GAAG,MAAM,eAAU,CAAC,QAAQ,CAAC,MAAM,CAAC,YAAY,EAAE;YAC5D,aAAa,EAAE,OAAO;SACvB,CAAC,CAAC;QACH,OAAO,MAAM,CAAC,UAAU,CAAC;IAC3B,CAAC;CACF,CAAA;AA9BY,sCAAa;wBAAb,aAAa;IADzB,IAAA,mBAAU,GAAE;;GACA,aAAa,CA8BzB","sourcesContent":["import { Injectable } from '@nestjs/common';\r\nimport { v2 as cloudinary } from 'cloudinary';\r\nimport { UploadApiResponse } from 'cloudinary';\r\n\r\n@Injectable()\r\nexport class UploadService {\r\n  constructor() {\r\n    cloudinary.config({\r\n      cloud_name: process.env.CLOUDINARY_CLOUD_NAME,\r\n      api_key: process.env.CLOUDINARY_API_KEY,\r\n      api_secret: process.env.CLOUDINARY_API_SECRET,\r\n    });\r\n  }\r\n\r\n  // Xử lý upload file\r\n  async uploadFile(file: Express.Multer.File): Promise<string> {\r\n    return new Promise((resolve, reject) => {\r\n      cloudinary.uploader\r\n        .upload_stream({ resource_type: 'image' }, (error: Error, result: UploadApiResponse) => {\r\n          if (error) {\r\n            return reject(error);\r\n          }\r\n          resolve(result.secure_url);\r\n        })\r\n        .end(file.buffer);\r\n    });\r\n  }\r\n\r\n  // Xử lý upload base64\r\n  async uploadBase64(base64String: string): Promise<string> {\r\n    const result = await cloudinary.uploader.upload(base64String, {\r\n      resource_type: 'image',\r\n    });\r\n    return result.secure_url;\r\n  }\r\n}"]}