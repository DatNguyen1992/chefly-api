{"version":3,"file":"is-object-id.decorator.js","sourceRoot":"","sources":["../../../src/common/decorators/is-object-id.decorator.ts"],"names":[],"mappings":";;;;;;;;;AAwBA,gCAUC;AAlCD,4CAAsD;AACtD,qDAKyB;AAGlB,IAAM,oBAAoB,GAA1B,MAAM,oBAAoB;IAC/B,QAAQ,CAAC,KAAU;QACjB,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE,CAAC;YACzB,OAAO,KAAK,CAAC,KAAK,CAChB,CAAC,CAAC,EAAE,EAAE,CAAC,OAAO,CAAC,KAAK,QAAQ,IAAI,6BAAiB,CAAC,IAAI,CAAC,CAAC,CAAC,CAC1D,CAAC;QACJ,CAAC;QACD,OAAO,OAAO,KAAK,KAAK,QAAQ,IAAI,6BAAiB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IACpE,CAAC;IAED,cAAc;QACZ,OAAO,gCAAgC,CAAC;IAC1C,CAAC;CACF,CAAA;AAbY,oDAAoB;+BAApB,oBAAoB;IADhC,IAAA,qCAAmB,EAAC,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC;GACzB,oBAAoB,CAahC;AAED,SAAgB,UAAU,CAAC,iBAAqC;IAC9D,OAAO,UAAU,MAAc,EAAE,YAAoB;QACnD,IAAA,mCAAiB,EAAC;YAChB,MAAM,EAAE,MAAM,CAAC,WAAW;YAC1B,YAAY,EAAE,YAAY;YAC1B,OAAO,EAAE,iBAAiB;YAC1B,WAAW,EAAE,EAAE;YACf,SAAS,EAAE,oBAAoB;SAChC,CAAC,CAAC;IACL,CAAC,CAAC;AACJ,CAAC","sourcesContent":["import { OBJECT_ID_PATTERN } from '@common/constants';\nimport {\n  registerDecorator,\n  ValidationOptions,\n  ValidatorConstraint,\n  ValidatorConstraintInterface,\n} from 'class-validator';\n\n@ValidatorConstraint({ async: false })\nexport class IsObjectIdConstraint implements ValidatorConstraintInterface {\n  validate(value: any) {\n    if (Array.isArray(value)) {\n      return value.every(\n        (v) => typeof v === 'string' && OBJECT_ID_PATTERN.test(v),\n      );\n    }\n    return typeof value === 'string' && OBJECT_ID_PATTERN.test(value);\n  }\n\n  defaultMessage() {\n    return 'Value must be a valid ObjectId';\n  }\n}\n\nexport function IsObjectId(validationOptions?: ValidationOptions) {\n  return function (object: object, propertyName: string) {\n    registerDecorator({\n      target: object.constructor,\n      propertyName: propertyName,\n      options: validationOptions,\n      constraints: [],\n      validator: IsObjectIdConstraint,\n    });\n  };\n}\n"]}